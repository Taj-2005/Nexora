(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,t,s)=>{t.exports=e.r(76562)},38938,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(18566),l=e.i(73620),r=e.i(9e4);let u=()=>r.apiClient.post("/api/auth/refresh",{},{withCredentials:!0}).then(e=>e.data);function n(e){var t;let s;return e?{id:e.id,email:e.email,fullName:e.fullName,role:(t=e.role,"CUSTOMER"===(s=t?.toUpperCase())?"customer":"ADMIN"===s?"admin":"SUPER_ADMIN"===s?"super_admin":"customer"),avatarUrl:e.avatarUrl,createdAt:e.createdAt}:null}let c=(0,s.createContext)(null);function i({children:e}){let i=(0,a.useRouter)(),[o,d]=(0,s.useState)(null),[h,p]=(0,s.useState)(!1),[k,C]=(0,s.useState)(!1),[f,m]=(0,s.useState)(null),A=(0,s.useCallback)(e=>{d(e)},[]),T=(0,s.useCallback)(async()=>{try{let e=await u();e.success&&e.accessToken&&e.user&&((0,l.setAccessToken)(e.accessToken,e.expiresIn),d(n(e.user)))}catch{(0,l.clearAccessToken)(),d(null)}},[]);(0,s.useEffect)(()=>((0,l.setOnUnauthorized)(()=>{(0,l.clearAccessToken)(),d(null),i.replace("/login")}),()=>(0,l.setOnUnauthorized)(null)),[i]),(0,s.useEffect)(()=>{u().then(e=>{e.success&&e.accessToken&&e.user&&((0,l.setAccessToken)(e.accessToken,e.expiresIn),d(n(e.user)))}).catch(()=>{(0,l.clearAccessToken)(),d(null)}).finally(()=>C(!0))},[]);let b=(0,s.useCallback)(async(e,t,s)=>{m(null),p(!0);try{let s,a,u=await (s=e,a=t,r.apiClient.post("/api/auth/login",{email:s,password:a}).then(e=>e.data));u.success&&u.accessToken&&u.user&&((0,l.setAccessToken)(u.accessToken,u.expiresIn),d(n(u.user)))}catch(e){throw m((0,r.toApiError)(e).message??"Login failed"),e}finally{p(!1)}},[]),w=(0,s.useCallback)(async(e,t,s,a)=>{m(null),p(!0);try{let u,c=await (u={fullName:e,email:t,password:s,roleRequest:"admin_request"===a?"admin":void 0},r.apiClient.post("/api/auth/register",u).then(e=>e.data));c.success&&c.accessToken&&c.user&&((0,l.setAccessToken)(c.accessToken,c.expiresIn),d(n(c.user)))}catch(e){throw m((0,r.toApiError)(e).message??"Registration failed"),e}finally{p(!1)}},[]),y=(0,s.useCallback)(async()=>{m(null);try{await r.apiClient.post("/api/auth/logout",{}).then(e=>e.data)}catch{}finally{(0,l.clearAccessToken)(),d(null)}},[]),S=(0,s.useCallback)(async e=>{m(null),p(!0);try{let t;await (t=e,r.apiClient.post("/api/auth/forgot-password",{email:t}).then(e=>e.data))}catch(e){throw m((0,r.toApiError)(e).message??"Request failed"),e}finally{p(!1)}},[]),v=(0,s.useCallback)(async(e,t)=>{m(null),p(!0);try{let s,a;await (s=e,a=t,r.apiClient.post("/api/auth/reset-password",{token:s,newPassword:a}).then(e=>e.data))}catch(e){throw m((0,r.toApiError)(e).message??"Reset failed"),e}finally{p(!1)}},[]),g=(0,s.useCallback)(()=>m(null),[]),x=(0,s.useMemo)(()=>({user:o,isAuthenticated:!!o,isLoading:h,isInitialized:k,login:b,register:w,logout:y,forgotPassword:S,resetPassword:v,refreshUser:T,setUser:A,error:f,clearError:g}),[o,h,k,b,w,y,S,v,T,A,f,g]);return(0,t.jsx)(c.Provider,{value:x,children:e})}function o(){let e=(0,s.useContext)(c);if(!e)throw Error("useAuth must be used within AuthProvider");return e}function d(){let{user:e}=o();return e?.role==="admin"||e?.role==="super_admin"}function h(){let{user:e}=o();return e?.role==="super_admin"}e.s(["AuthProvider",()=>i,"useAuth",()=>o,"useIsAdmin",()=>d,"useIsSuperAdmin",()=>h],38938)},50079,e=>{"use strict";var t=e.i(43476),s=e.i(71645);let a=(0,s.createContext)(null);function l({children:e}){let[l,r]=(0,s.useState)({}),[u,n]=(0,s.useState)(new Set),c=(0,s.useMemo)(()=>Object.values(l).reduce((e,t)=>e+t,0),[l]),i=u.size,o=(0,s.useCallback)((e,t=1)=>{r(s=>({...s,[e]:(s[e]??0)+t}))},[]),d=(0,s.useCallback)(e=>{r(t=>{let s={...t};return delete s[e],s})},[]),h=(0,s.useCallback)((e,t)=>{t<1?r(t=>{let s={...t};return delete s[e],s}):r(s=>({...s,[e]:t}))},[]),p=(0,s.useCallback)(e=>{n(t=>{let s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})},[]),k=(0,s.useCallback)(e=>u.has(e),[u]),C=(0,s.useCallback)(e=>{o(e,1),n(t=>{let s=new Set(t);return s.delete(e),s})},[o]),f=(0,s.useMemo)(()=>({cart:l,wishlist:u,cartCount:c,wishlistCount:i,addToCart:o,removeFromCart:d,updateQuantity:h,toggleWishlist:p,isInWishlist:k,moveToCart:C}),[l,u,c,i,o,d,h,p,k,C]);return(0,t.jsx)(a.Provider,{value:f,children:e})}function r(){let e=(0,s.useContext)(a);if(!e)throw Error("useShop must be used within ShopProvider");return e}e.s(["ShopProvider",()=>l,"useShop",()=>r])}]);