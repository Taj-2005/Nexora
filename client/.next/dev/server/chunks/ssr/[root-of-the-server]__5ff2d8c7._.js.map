{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///Users/Taj786/projects/shop_smart/client/context/shop-context.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n  createContext,\n  useContext,\n  useCallback,\n  useMemo,\n  useState,\n  type ReactNode,\n} from \"react\";\n\nexport type CartState = Record<string, number>;\n\nexport type WishlistState = Set<string>;\n\ntype ShopContextValue = {\n  cart: CartState;\n  wishlist: WishlistState;\n  cartCount: number;\n  wishlistCount: number;\n  addToCart: (productId: string, quantity?: number) => void;\n  removeFromCart: (productId: string) => void;\n  updateQuantity: (productId: string, quantity: number) => void;\n  toggleWishlist: (productId: string) => void;\n  isInWishlist: (productId: string) => boolean;\n  moveToCart: (productId: string) => void;\n};\n\nconst ShopContext = createContext<ShopContextValue | null>(null);\n\nexport function ShopProvider({ children }: { children: ReactNode }) {\n  const [cart, setCart] = useState<CartState>({});\n  const [wishlist, setWishlist] = useState<WishlistState>(new Set());\n\n  const cartCount = useMemo(\n    () => Object.values(cart).reduce((s, q) => s + q, 0),\n    [cart]\n  );\n  const wishlistCount = wishlist.size;\n\n  const addToCart = useCallback((productId: string, quantity = 1) => {\n    setCart((prev) => ({\n      ...prev,\n      [productId]: (prev[productId] ?? 0) + quantity,\n    }));\n  }, []);\n\n  const removeFromCart = useCallback((productId: string) => {\n    setCart((prev) => {\n      const next = { ...prev };\n      delete next[productId];\n      return next;\n    });\n  }, []);\n\n  const updateQuantity = useCallback((productId: string, quantity: number) => {\n    if (quantity < 1) {\n      setCart((prev) => {\n        const next = { ...prev };\n        delete next[productId];\n        return next;\n      });\n      return;\n    }\n    setCart((prev) => ({ ...prev, [productId]: quantity }));\n  }, []);\n\n  const toggleWishlist = useCallback((productId: string) => {\n    setWishlist((prev) => {\n      const next = new Set(prev);\n      if (next.has(productId)) next.delete(productId);\n      else next.add(productId);\n      return next;\n    });\n  }, []);\n\n  const isInWishlist = useCallback(\n    (productId: string) => wishlist.has(productId),\n    [wishlist]\n  );\n\n  const moveToCart = useCallback((productId: string) => {\n    addToCart(productId, 1);\n    setWishlist((prev) => {\n      const next = new Set(prev);\n      next.delete(productId);\n      return next;\n    });\n  }, [addToCart]);\n\n  const value = useMemo<ShopContextValue>(\n    () => ({\n      cart,\n      wishlist,\n      cartCount,\n      wishlistCount,\n      addToCart,\n      removeFromCart,\n      updateQuantity,\n      toggleWishlist,\n      isInWishlist,\n      moveToCart,\n    }),\n    [\n      cart,\n      wishlist,\n      cartCount,\n      wishlistCount,\n      addToCart,\n      removeFromCart,\n      updateQuantity,\n      toggleWishlist,\n      isInWishlist,\n      moveToCart,\n    ]\n  );\n\n  return (\n    <ShopContext.Provider value={value}>{children}</ShopContext.Provider>\n  );\n}\n\nexport function useShop() {\n  const ctx = useContext(ShopContext);\n  if (!ctx) throw new Error(\"useShop must be used within ShopProvider\");\n  return ctx;\n}\n"],"names":[],"mappings":";;;;;;;AAEA;AAFA;;;AA4BA,MAAM,4BAAc,IAAA,sNAAa,EAA0B;AAEpD,SAAS,aAAa,EAAE,QAAQ,EAA2B;IAChE,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAY,CAAC;IAC7C,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAgB,IAAI;IAE5D,MAAM,YAAY,IAAA,gNAAO,EACvB,IAAM,OAAO,MAAM,CAAC,MAAM,MAAM,CAAC,CAAC,GAAG,IAAM,IAAI,GAAG,IAClD;QAAC;KAAK;IAER,MAAM,gBAAgB,SAAS,IAAI;IAEnC,MAAM,YAAY,IAAA,oNAAW,EAAC,CAAC,WAAmB,WAAW,CAAC;QAC5D,QAAQ,CAAC,OAAS,CAAC;gBACjB,GAAG,IAAI;gBACP,CAAC,UAAU,EAAE,CAAC,IAAI,CAAC,UAAU,IAAI,CAAC,IAAI;YACxC,CAAC;IACH,GAAG,EAAE;IAEL,MAAM,iBAAiB,IAAA,oNAAW,EAAC,CAAC;QAClC,QAAQ,CAAC;YACP,MAAM,OAAO;gBAAE,GAAG,IAAI;YAAC;YACvB,OAAO,IAAI,CAAC,UAAU;YACtB,OAAO;QACT;IACF,GAAG,EAAE;IAEL,MAAM,iBAAiB,IAAA,oNAAW,EAAC,CAAC,WAAmB;QACrD,IAAI,WAAW,GAAG;YAChB,QAAQ,CAAC;gBACP,MAAM,OAAO;oBAAE,GAAG,IAAI;gBAAC;gBACvB,OAAO,IAAI,CAAC,UAAU;gBACtB,OAAO;YACT;YACA;QACF;QACA,QAAQ,CAAC,OAAS,CAAC;gBAAE,GAAG,IAAI;gBAAE,CAAC,UAAU,EAAE;YAAS,CAAC;IACvD,GAAG,EAAE;IAEL,MAAM,iBAAiB,IAAA,oNAAW,EAAC,CAAC;QAClC,YAAY,CAAC;YACX,MAAM,OAAO,IAAI,IAAI;YACrB,IAAI,KAAK,GAAG,CAAC,YAAY,KAAK,MAAM,CAAC;iBAChC,KAAK,GAAG,CAAC;YACd,OAAO;QACT;IACF,GAAG,EAAE;IAEL,MAAM,eAAe,IAAA,oNAAW,EAC9B,CAAC,YAAsB,SAAS,GAAG,CAAC,YACpC;QAAC;KAAS;IAGZ,MAAM,aAAa,IAAA,oNAAW,EAAC,CAAC;QAC9B,UAAU,WAAW;QACrB,YAAY,CAAC;YACX,MAAM,OAAO,IAAI,IAAI;YACrB,KAAK,MAAM,CAAC;YACZ,OAAO;QACT;IACF,GAAG;QAAC;KAAU;IAEd,MAAM,QAAQ,IAAA,gNAAO,EACnB,IAAM,CAAC;YACL;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;QACF,CAAC,GACD;QACE;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;KACD;IAGH,qBACE,8OAAC,YAAY,QAAQ;QAAC,OAAO;kBAAQ;;;;;;AAEzC;AAEO,SAAS;IACd,MAAM,MAAM,IAAA,mNAAU,EAAC;IACvB,IAAI,CAAC,KAAK,MAAM,IAAI,MAAM;IAC1B,OAAO;AACT"}},
    {"offset": {"line": 140, "column": 0}, "map": {"version":3,"sources":["file:///Users/Taj786/projects/shop_smart/client/lib/auth-token.ts"],"sourcesContent":["\"use client\";\n\n/**\n * In-memory access token store. Used by axios interceptor.\n * No localStorage â€” refresh token is HttpOnly cookie only.\n */\n\nlet accessToken: string | null = null;\nlet expiresAt: number | null = null;\n\nexport function setAccessToken(token: string, expiresInSeconds: number): void {\n  accessToken = token;\n  expiresAt = Date.now() + expiresInSeconds * 1000;\n}\n\nexport function getAccessToken(): string | null {\n  return accessToken;\n}\n\nexport function getExpiresAt(): number | null {\n  return expiresAt;\n}\n\nexport function isAccessTokenExpired(): boolean {\n  if (!expiresAt) return true;\n  return Date.now() >= expiresAt - 60 * 1000; // 1 min buffer\n}\n\nexport function clearAccessToken(): void {\n  accessToken = null;\n  expiresAt = null;\n}\n\ntype OnUnauthorized = () => void;\nlet onUnauthorized: OnUnauthorized | null = null;\n\nexport function setOnUnauthorized(cb: OnUnauthorized | null): void {\n  onUnauthorized = cb;\n}\n\nexport function triggerUnauthorized(): void {\n  onUnauthorized?.();\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAAA;AAEA;;;CAGC,GAED,IAAI,cAA6B;AACjC,IAAI,YAA2B;AAExB,SAAS,eAAe,KAAa,EAAE,gBAAwB;IACpE,cAAc;IACd,YAAY,KAAK,GAAG,KAAK,mBAAmB;AAC9C;AAEO,SAAS;IACd,OAAO;AACT;AAEO,SAAS;IACd,OAAO;AACT;AAEO,SAAS;IACd,IAAI,CAAC,WAAW,OAAO;IACvB,OAAO,KAAK,GAAG,MAAM,YAAY,KAAK,MAAM,eAAe;AAC7D;AAEO,SAAS;IACd,cAAc;IACd,YAAY;AACd;AAGA,IAAI,iBAAwC;AAErC,SAAS,kBAAkB,EAAyB;IACzD,iBAAiB;AACnB;AAEO,SAAS;IACd;AACF"}},
    {"offset": {"line": 275, "column": 0}, "map": {"version":3,"sources":["file:///Users/Taj786/projects/shop_smart/client/api/axios.ts"],"sourcesContent":["\"use client\";\n\nimport axios, { type AxiosError, type InternalAxiosRequestConfig } from \"axios\";\nimport { getAccessToken, setAccessToken, clearAccessToken, triggerUnauthorized } from \"@/lib/auth-token\";\n\nconst baseURL = process.env.NEXT_PUBLIC_API_URL ?? \"http://localhost:4000\";\n\nexport const apiClient = axios.create({\n  baseURL,\n  timeout: 30000,\n  withCredentials: true,\n  headers: { \"Content-Type\": \"application/json\" },\n});\n\nlet refreshPromise: Promise<string | null> | null = null;\n\nasync function refreshAccessToken(): Promise<string | null> {\n  if (refreshPromise) return refreshPromise;\n  refreshPromise = apiClient\n    .post<{ success: boolean; accessToken: string; expiresIn: number; user: { id: string; email: string; fullName: string; role: string; avatarUrl?: string; createdAt: string } }>(\n      \"/api/auth/refresh\",\n      {},\n      { withCredentials: true }\n    )\n    .then((res) => {\n      const data = res.data;\n      if (data.success && data.accessToken) {\n        setAccessToken(data.accessToken, data.expiresIn);\n        return data.accessToken;\n      }\n      return null;\n    })\n    .catch(() => null)\n    .finally(() => {\n      refreshPromise = null;\n    });\n  return refreshPromise;\n}\n\napiClient.interceptors.request.use((config: InternalAxiosRequestConfig) => {\n  const token = getAccessToken();\n  if (token) config.headers.Authorization = `Bearer ${token}`;\n  return config;\n});\n\napiClient.interceptors.response.use(\n  (res) => res,\n  async (err: AxiosError) => {\n    const original = err.config as InternalAxiosRequestConfig & { _retry?: boolean };\n    if (err.response?.status !== 401 || original._retry) {\n      if (err.response?.status === 401) triggerUnauthorized();\n      return Promise.reject(err);\n    }\n    original._retry = true;\n    const newToken = await refreshAccessToken();\n    if (newToken) {\n      original.headers.Authorization = `Bearer ${newToken}`;\n      return apiClient(original);\n    }\n    clearAccessToken();\n    triggerUnauthorized();\n    return Promise.reject(err);\n  }\n);\n\nexport type ApiError = {\n  status: number;\n  message: string;\n  code?: string;\n  errors?: Record<string, string[]>;\n};\n\nexport function toApiError(err: unknown): ApiError {\n  if (axios.isAxiosError(err)) {\n    const data = err.response?.data as { message?: string; code?: string; errors?: Record<string, string[]> } | undefined;\n    return {\n      status: err.response?.status ?? 500,\n      message: data?.message ?? err.message ?? \"Request failed\",\n      code: data?.code,\n      errors: data?.errors,\n    };\n  }\n  return { status: 500, message: \"Request failed\" };\n}\n"],"names":[],"mappings":";;;;;;AAEA;AACA;AAHA;;;AAKA,MAAM,UAAU,6DAAmC;AAE5C,MAAM,YAAY,gJAAK,CAAC,MAAM,CAAC;IACpC;IACA,SAAS;IACT,iBAAiB;IACjB,SAAS;QAAE,gBAAgB;IAAmB;AAChD;AAEA,IAAI,iBAAgD;AAEpD,eAAe;IACb,IAAI,gBAAgB,OAAO;IAC3B,iBAAiB,UACd,IAAI,CACH,qBACA,CAAC,GACD;QAAE,iBAAiB;IAAK,GAEzB,IAAI,CAAC,CAAC;QACL,MAAM,OAAO,IAAI,IAAI;QACrB,IAAI,KAAK,OAAO,IAAI,KAAK,WAAW,EAAE;YACpC,IAAA,sIAAc,EAAC,KAAK,WAAW,EAAE,KAAK,SAAS;YAC/C,OAAO,KAAK,WAAW;QACzB;QACA,OAAO;IACT,GACC,KAAK,CAAC,IAAM,MACZ,OAAO,CAAC;QACP,iBAAiB;IACnB;IACF,OAAO;AACT;AAEA,UAAU,YAAY,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;IAClC,MAAM,QAAQ,IAAA,sIAAc;IAC5B,IAAI,OAAO,OAAO,OAAO,CAAC,aAAa,GAAG,CAAC,OAAO,EAAE,OAAO;IAC3D,OAAO;AACT;AAEA,UAAU,YAAY,CAAC,QAAQ,CAAC,GAAG,CACjC,CAAC,MAAQ,KACT,OAAO;IACL,MAAM,WAAW,IAAI,MAAM;IAC3B,IAAI,IAAI,QAAQ,EAAE,WAAW,OAAO,SAAS,MAAM,EAAE;QACnD,IAAI,IAAI,QAAQ,EAAE,WAAW,KAAK,IAAA,2IAAmB;QACrD,OAAO,QAAQ,MAAM,CAAC;IACxB;IACA,SAAS,MAAM,GAAG;IAClB,MAAM,WAAW,MAAM;IACvB,IAAI,UAAU;QACZ,SAAS,OAAO,CAAC,aAAa,GAAG,CAAC,OAAO,EAAE,UAAU;QACrD,OAAO,UAAU;IACnB;IACA,IAAA,wIAAgB;IAChB,IAAA,2IAAmB;IACnB,OAAO,QAAQ,MAAM,CAAC;AACxB;AAUK,SAAS,WAAW,GAAY;IACrC,IAAI,gJAAK,CAAC,YAAY,CAAC,MAAM;QAC3B,MAAM,OAAO,IAAI,QAAQ,EAAE;QAC3B,OAAO;YACL,QAAQ,IAAI,QAAQ,EAAE,UAAU;YAChC,SAAS,MAAM,WAAW,IAAI,OAAO,IAAI;YACzC,MAAM,MAAM;YACZ,QAAQ,MAAM;QAChB;IACF;IACA,OAAO;QAAE,QAAQ;QAAK,SAAS;IAAiB;AAClD"}},
    {"offset": {"line": 352, "column": 0}, "map": {"version":3,"sources":["file:///Users/Taj786/projects/shop_smart/client/api/auth.api.ts"],"sourcesContent":["\"use client\";\n\nimport { apiClient } from \"./axios\";\n\nexport type AuthUser = {\n  id: string;\n  email: string;\n  fullName: string;\n  role: string;\n  avatarUrl?: string;\n  emailVerified?: boolean;\n  createdAt: string;\n};\n\nexport type LoginResponse = {\n  success: boolean;\n  accessToken: string;\n  expiresIn: number;\n  user: AuthUser;\n};\n\nexport type MeResponse = { success: boolean; user: AuthUser };\n\nexport const authApi = {\n  login: (email: string, password: string) =>\n    apiClient.post<LoginResponse>(\"/api/auth/login\", { email, password }).then((r) => r.data),\n\n  register: (data: { fullName: string; email: string; password: string; roleRequest?: string }) =>\n    apiClient.post<LoginResponse>(\"/api/auth/register\", data).then((r) => r.data),\n\n  logout: () => apiClient.post(\"/api/auth/logout\", {}).then((r) => r.data),\n\n  refresh: () =>\n    apiClient\n      .post<LoginResponse>(\"/api/auth/refresh\", {}, { withCredentials: true })\n      .then((r) => r.data),\n\n  me: () => apiClient.get<MeResponse>(\"/api/auth/me\").then((r) => r.data),\n\n  forgotPassword: (email: string) =>\n    apiClient.post(\"/api/auth/forgot-password\", { email }).then((r) => r.data),\n\n  resetPassword: (token: string, newPassword: string) =>\n    apiClient.post(\"/api/auth/reset-password\", { token, newPassword }).then((r) => r.data),\n\n  verifyEmail: (token: string) =>\n    apiClient.post<{ success: boolean; user: AuthUser }>(\"/api/auth/verify-email\", { token }).then((r) => r.data),\n};\n"],"names":[],"mappings":";;;;AAEA;AAFA;;AAuBO,MAAM,UAAU;IACrB,OAAO,CAAC,OAAe,WACrB,yHAAS,CAAC,IAAI,CAAgB,mBAAmB;YAAE;YAAO;QAAS,GAAG,IAAI,CAAC,CAAC,IAAM,EAAE,IAAI;IAE1F,UAAU,CAAC,OACT,yHAAS,CAAC,IAAI,CAAgB,sBAAsB,MAAM,IAAI,CAAC,CAAC,IAAM,EAAE,IAAI;IAE9E,QAAQ,IAAM,yHAAS,CAAC,IAAI,CAAC,oBAAoB,CAAC,GAAG,IAAI,CAAC,CAAC,IAAM,EAAE,IAAI;IAEvE,SAAS,IACP,yHAAS,CACN,IAAI,CAAgB,qBAAqB,CAAC,GAAG;YAAE,iBAAiB;QAAK,GACrE,IAAI,CAAC,CAAC,IAAM,EAAE,IAAI;IAEvB,IAAI,IAAM,yHAAS,CAAC,GAAG,CAAa,gBAAgB,IAAI,CAAC,CAAC,IAAM,EAAE,IAAI;IAEtE,gBAAgB,CAAC,QACf,yHAAS,CAAC,IAAI,CAAC,6BAA6B;YAAE;QAAM,GAAG,IAAI,CAAC,CAAC,IAAM,EAAE,IAAI;IAE3E,eAAe,CAAC,OAAe,cAC7B,yHAAS,CAAC,IAAI,CAAC,4BAA4B;YAAE;YAAO;QAAY,GAAG,IAAI,CAAC,CAAC,IAAM,EAAE,IAAI;IAEvF,aAAa,CAAC,QACZ,yHAAS,CAAC,IAAI,CAAuC,0BAA0B;YAAE;QAAM,GAAG,IAAI,CAAC,CAAC,IAAM,EAAE,IAAI;AAChH"}},
    {"offset": {"line": 385, "column": 0}, "map": {"version":3,"sources":["file:///Users/Taj786/projects/shop_smart/client/context/auth-context.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n  createContext,\n  useCallback,\n  useContext,\n  useEffect,\n  useMemo,\n  useState,\n  type ReactNode,\n} from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport type { User, UserRole } from \"@/types/auth\";\nimport { setAccessToken, clearAccessToken, setOnUnauthorized } from \"@/lib/auth-token\";\nimport { authApi, type AuthUser } from \"@/api/auth.api\";\nimport { toApiError } from \"@/api/axios\";\n\nfunction normalizeRole(role: string): UserRole {\n  const r = role?.toUpperCase();\n  if (r === \"CUSTOMER\") return \"customer\";\n  if (r === \"ADMIN\") return \"admin\";\n  if (r === \"SUPER_ADMIN\") return \"super_admin\";\n  return \"customer\";\n}\n\nfunction toUser(u: AuthUser | null): User | null {\n  if (!u) return null;\n  return {\n    id: u.id,\n    email: u.email,\n    fullName: u.fullName,\n    role: normalizeRole(u.role),\n    avatarUrl: u.avatarUrl,\n    createdAt: u.createdAt,\n  };\n}\n\ntype AuthState = {\n  user: User | null;\n  isAuthenticated: boolean;\n  isLoading: boolean;\n  isInitialized: boolean;\n};\n\ntype AuthContextValue = AuthState & {\n  login: (email: string, password: string, remember?: boolean) => Promise<void>;\n  register: (fullName: string, email: string, password: string, role?: \"customer\" | \"admin_request\") => Promise<void>;\n  logout: () => Promise<void>;\n  forgotPassword: (email: string) => Promise<void>;\n  resetPassword: (token: string, newPassword: string) => Promise<void>;\n  refreshUser: () => Promise<void>;\n  setUser: (user: User | null) => void;\n  error: string | null;\n  clearError: () => void;\n};\n\nconst AuthContext = createContext<AuthContextValue | null>(null);\n\nexport function AuthProvider({ children }: { children: ReactNode }) {\n  const router = useRouter();\n  const [user, setUserState] = useState<User | null>(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [isInitialized, setIsInitialized] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const setUser = useCallback((u: User | null) => {\n    setUserState(u);\n  }, []);\n\n  const refreshUser = useCallback(async () => {\n    try {\n      const data = await authApi.refresh();\n      if (data.success && data.accessToken && data.user) {\n        setAccessToken(data.accessToken, data.expiresIn);\n        setUserState(toUser(data.user));\n      }\n    } catch {\n      clearAccessToken();\n      setUserState(null);\n    }\n  }, []);\n\n  useEffect(() => {\n    setOnUnauthorized(() => {\n      clearAccessToken();\n      setUserState(null);\n      if (typeof window !== \"undefined\") router.replace(\"/login\");\n    });\n    return () => setOnUnauthorized(null);\n  }, [router]);\n\n  useEffect(() => {\n    authApi\n      .refresh()\n      .then((data) => {\n        if (data.success && data.accessToken && data.user) {\n          setAccessToken(data.accessToken, data.expiresIn);\n          setUserState(toUser(data.user));\n        }\n      })\n      .catch(() => {\n        clearAccessToken();\n        setUserState(null);\n      })\n      .finally(() => setIsInitialized(true));\n  }, []);\n\n  const login = useCallback(\n    async (email: string, password: string, _remember?: boolean) => {\n      setError(null);\n      setIsLoading(true);\n      try {\n        const data = await authApi.login(email, password);\n        if (data.success && data.accessToken && data.user) {\n          setAccessToken(data.accessToken, data.expiresIn);\n          setUserState(toUser(data.user));\n        }\n      } catch (e) {\n        const err = toApiError(e);\n        setError(err.message ?? \"Login failed\");\n        throw e;\n      } finally {\n        setIsLoading(false);\n      }\n    },\n    []\n  );\n\n  const register = useCallback(\n    async (\n      fullName: string,\n      email: string,\n      password: string,\n      role?: \"customer\" | \"admin_request\"\n    ) => {\n      setError(null);\n      setIsLoading(true);\n      try {\n        const data = await authApi.register({\n          fullName,\n          email,\n          password,\n          roleRequest: role === \"admin_request\" ? \"admin\" : undefined,\n        });\n        if (data.success && data.accessToken && data.user) {\n          setAccessToken(data.accessToken, data.expiresIn);\n          setUserState(toUser(data.user));\n        }\n      } catch (e) {\n        const err = toApiError(e);\n        setError(err.message ?? \"Registration failed\");\n        throw e;\n      } finally {\n        setIsLoading(false);\n      }\n    },\n    []\n  );\n\n  const logout = useCallback(async () => {\n    setError(null);\n    try {\n      await authApi.logout();\n    } catch {\n      // ignore\n    } finally {\n      clearAccessToken();\n      setUserState(null);\n    }\n  }, []);\n\n  const forgotPassword = useCallback(async (email: string) => {\n    setError(null);\n    setIsLoading(true);\n    try {\n      await authApi.forgotPassword(email);\n    } catch (e) {\n      const err = toApiError(e);\n      setError(err.message ?? \"Request failed\");\n      throw e;\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  const resetPassword = useCallback(async (token: string, newPassword: string) => {\n    setError(null);\n    setIsLoading(true);\n    try {\n      await authApi.resetPassword(token, newPassword);\n    } catch (e) {\n      const err = toApiError(e);\n      setError(err.message ?? \"Reset failed\");\n      throw e;\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  const clearError = useCallback(() => setError(null), []);\n\n  const value = useMemo<AuthContextValue>(\n    () => ({\n      user,\n      isAuthenticated: !!user,\n      isLoading,\n      isInitialized,\n      login,\n      register,\n      logout,\n      forgotPassword,\n      resetPassword,\n      refreshUser,\n      setUser,\n      error,\n      clearError,\n    }),\n    [\n      user,\n      isLoading,\n      isInitialized,\n      login,\n      register,\n      logout,\n      forgotPassword,\n      resetPassword,\n      refreshUser,\n      setUser,\n      error,\n      clearError,\n    ]\n  );\n\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\n}\n\nexport function useAuth() {\n  const ctx = useContext(AuthContext);\n  if (!ctx) throw new Error(\"useAuth must be used within AuthProvider\");\n  return ctx;\n}\n\nexport function useIsAdmin(): boolean {\n  const { user } = useAuth();\n  return user?.role === \"admin\" || user?.role === \"super_admin\";\n}\n\nexport function useIsSuperAdmin(): boolean {\n  const { user } = useAuth();\n  return user?.role === \"super_admin\";\n}\n"],"names":[],"mappings":"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"}}]
}