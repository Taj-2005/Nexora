{"version":3,"sources":["../../../../node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-dom.ts","../../../../components/auth/protected-route.tsx","../../../../app/orders/page.tsx","../../../../api/order.api.ts"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactDOM\n","\"use client\";\n\nimport { useEffect, type ReactNode } from \"react\";\nimport { useRouter, usePathname } from \"next/navigation\";\nimport { useAuth } from \"@/context/auth-context\";\nimport type { UserRole } from \"@/types/auth\";\n\ntype ProtectedRouteProps = {\n  children: ReactNode;\n  requiredRole?: UserRole | UserRole[];\n  fallback?: ReactNode;\n};\n\nexport function ProtectedRoute({\n  children,\n  requiredRole,\n  fallback = null,\n}: ProtectedRouteProps) {\n  const router = useRouter();\n  const pathname = usePathname();\n  const { user, isAuthenticated, isInitialized, isLoading } = useAuth();\n\n  const allowed = (() => {\n    if (!requiredRole) return true;\n    if (!user) return false;\n    const roles = Array.isArray(requiredRole) ? requiredRole : [requiredRole];\n    return roles.includes(user.role);\n  })();\n\n  useEffect(() => {\n    if (!isInitialized) return;\n    if (!isAuthenticated) {\n      router.replace(`/login?redirect=${encodeURIComponent(pathname ?? \"/\")}`);\n      return;\n    }\n    if (!allowed) {\n      router.replace(user?.role === \"customer\" ? \"/home\" : \"/admin\");\n      return;\n    }\n  }, [isInitialized, isAuthenticated, allowed, pathname, router, user?.role]);\n\n  if (!isInitialized || isLoading) {\n    return fallback ?? <ProtectedRouteSkeleton />;\n  }\n  if (!isAuthenticated || !allowed) {\n    return fallback ?? <ProtectedRouteSkeleton />;\n  }\n  return <>{children}</>;\n}\n\nexport function ProtectedRouteSkeleton() {\n  return (\n    <div className=\"flex min-h-[50vh] items-center justify-center bg-muted/30\">\n      <div className=\"h-8 w-8 animate-spin rounded-full border-2 border-accent border-t-transparent\" aria-hidden />\n      <span className=\"sr-only\">Loading…</span>\n    </div>\n  );\n}\n\nexport function AdminRoute({ children, fallback }: { children: ReactNode; fallback?: ReactNode }) {\n  return (\n    <ProtectedRoute requiredRole={[\"admin\", \"super_admin\"]} fallback={fallback}>\n      {children}\n    </ProtectedRoute>\n  );\n}\n\nexport function SuperAdminRoute({ children, fallback }: { children: ReactNode; fallback?: ReactNode }) {\n  return (\n    <ProtectedRoute requiredRole=\"super_admin\" fallback={fallback}>\n      {children}\n    </ProtectedRoute>\n  );\n}\n","\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport Link from \"next/link\";\nimport Image from \"next/image\";\nimport { useAuth } from \"@/context/auth-context\";\nimport { ProtectedRoute } from \"@/components/auth/protected-route\";\nimport { Container } from \"@/components/layout/container\";\nimport { orderApi, type ApiOrder } from \"@/api/order.api\";\n\nfunction formatPrice(n: number) {\n  return `₹${n.toLocaleString(\"en-IN\")}`;\n}\n\nfunction formatDate(s: string) {\n  return new Date(s).toLocaleDateString(\"en-IN\", {\n    day: \"numeric\",\n    month: \"short\",\n    year: \"numeric\",\n  });\n}\n\nfunction OrderCard({ order }: { order: ApiOrder }) {\n  const [expanded, setExpanded] = useState(false);\n  const status = order.status?.toLowerCase() ?? \"pending\";\n\n  return (\n    <div className=\"rounded-[var(--radius-lg)] border border-border bg-surface overflow-hidden\">\n      <button\n        type=\"button\"\n        onClick={() => setExpanded((e) => !e)}\n        className=\"flex w-full items-center justify-between gap-4 p-4 text-left hover:bg-muted/50 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:ring-accent\"\n      >\n        <div className=\"min-w-0\">\n          <p className=\"font-heading font-semibold text-primary\">{order.id.slice(0, 8)}…</p>\n          <p className=\"text-sm text-muted-foreground\">{formatDate(order.createdAt)}</p>\n        </div>\n        <div className=\"flex items-center gap-3 shrink-0\">\n          <span className=\"rounded-full px-2.5 py-0.5 text-xs font-medium capitalize bg-muted text-muted-foreground\">\n            {status}\n          </span>\n          <span className=\"font-semibold text-primary\">{formatPrice(order.total)}</span>\n          <span className=\"text-muted-foreground\" aria-hidden>{expanded ? \"▼\" : \"▶\"}</span>\n        </div>\n      </button>\n      {expanded && (\n        <div className=\"border-t border-border p-4 space-y-4\">\n          <ul className=\"space-y-2\">\n            {order.items?.map((item) => (\n              <li key={item.id} className=\"flex gap-3 text-sm\">\n                {item.product?.image && (\n                  <div className=\"relative h-12 w-12 shrink-0 overflow-hidden rounded bg-muted\">\n                    <Image src={item.product.image} alt={item.product?.name ?? \"\"} fill className=\"object-cover\" />\n                  </div>\n                )}\n                <div className=\"min-w-0\">\n                  <p className=\"font-medium text-primary\">{item.product?.name ?? \"Item\"}</p>\n                  <p className=\"text-muted-foreground\">\n                    Qty: {item.quantity} × {formatPrice(item.price)}\n                  </p>\n                </div>\n              </li>\n            ))}\n          </ul>\n          <Link\n            href=\"/shop\"\n            className=\"inline-block rounded-[var(--radius-sm)] bg-accent px-3 py-2 text-sm font-medium text-on-accent hover:bg-accent/90\"\n          >\n            Order again\n          </Link>\n        </div>\n      )}\n    </div>\n  );\n}\n\nfunction OrdersContent() {\n  const [orders, setOrders] = useState<ApiOrder[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    orderApi\n      .list()\n      .then((res) => {\n        if (res.success && res.data) setOrders(res.data);\n      })\n      .catch(() => setError(\"Failed to load orders\"))\n      .finally(() => setLoading(false));\n  }, []);\n\n  if (loading) {\n    return (\n      <div className=\"flex min-h-[200px] items-center justify-center\">\n        <div className=\"h-8 w-8 animate-spin rounded-full border-2 border-accent border-t-transparent\" aria-hidden />\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <Container as=\"div\" className=\"py-8 lg:py-12\">\n        <div className=\"rounded-[var(--radius-lg)] border border-[var(--color-error)] bg-[var(--color-error)]/10 p-6 text-[var(--color-error)]\">\n          {error}\n        </div>\n      </Container>\n    );\n  }\n\n  return (\n    <Container as=\"div\" className=\"py-8 lg:py-12\">\n      <h1 className=\"font-heading text-3xl font-bold tracking-tight text-primary\">\n        Order history\n      </h1>\n      <p className=\"mt-2 text-muted-foreground\">\n        View and manage your orders.\n      </p>\n\n      {orders.length === 0 ? (\n        <div className=\"mt-12 rounded-[var(--radius-lg)] border border-border bg-surface py-16 text-center\">\n          <p className=\"text-muted-foreground\">You haven’t placed any orders yet.</p>\n          <Link\n            href=\"/shop\"\n            className=\"mt-6 inline-flex h-12 items-center justify-center rounded-[var(--radius)] bg-accent px-6 text-sm font-medium text-on-accent hover:bg-accent/90\"\n          >\n            Start shopping\n          </Link>\n        </div>\n      ) : (\n        <ul className=\"mt-8 space-y-4\" role=\"list\">\n          {orders.map((order) => (\n            <li key={order.id}>\n              <OrderCard order={order} />\n            </li>\n          ))}\n        </ul>\n      )}\n    </Container>\n  );\n}\n\nexport default function OrdersPage() {\n  return (\n    <ProtectedRoute>\n      <OrdersContent />\n    </ProtectedRoute>\n  );\n}\n","\"use client\";\n\nimport { apiClient } from \"./axios\";\n\nexport type ApiOrderItem = {\n  id: string;\n  productId: string;\n  product?: { id: string; name: string; image?: string };\n  quantity: number;\n  price: number;\n};\n\nexport type ApiOrder = {\n  id: string;\n  userId: string;\n  status: string;\n  subtotal: number;\n  discount: number;\n  shipping: number;\n  total: number;\n  addressId?: string;\n  items: ApiOrderItem[];\n  createdAt: string;\n  updatedAt: string;\n};\n\nexport type ApiResponse<T> = { success: boolean; data: T };\n\nexport const orderApi = {\n  create: (data: { addressId?: string; items: { productId: string; quantity: number }[] }) =>\n    apiClient.post<ApiResponse<ApiOrder>>(\"/api/orders\", data).then((r) => r.data),\n\n  list: () =>\n    apiClient.get<ApiResponse<ApiOrder[]>>(\"/api/orders\").then((r) => r.data),\n\n  getById: (id: string) =>\n    apiClient.get<ApiResponse<ApiOrder>>(`/api/orders/${id}`).then((r) => r.data),\n\n  updateStatus: (id: string, status: string) =>\n    apiClient.patch<ApiResponse<ApiOrder>>(`/api/orders/${id}/status`, { status }).then((r) => r.data),\n};\n"],"names":["module","exports","require","vendored","ReactDOM"],"mappings":"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","ignoreList":[0]}